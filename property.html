
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bmd Immobilier - تفاصيل العقار</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="header-left">
                    <a href="index.html" class="logo">
                        <i class="fas fa-home"></i>
                        Bmd Immobilier
                    </a>
                </div>
                
                <div class="header-center">
                    <div class="search-bar">
                        <div class="search-item">
                            <label>الموقع</label>
                            <input type="text" placeholder="أين تريد البحث؟">
                        </div>
                        <div class="search-divider"></div>
                        <div class="search-item">
                            <label>النوع</label>
                            <select>
                                <option>جميع الأنواع</option>
                                <option>شقة</option>
                                <option>فيلا</option>
                                <option>مكتب</option>
                            </select>
                        </div>
                        <div class="search-divider"></div>
                        <div class="search-item">
                            <label>السعر</label>
                            <input type="text" placeholder="أي سعر">
                        </div>
                        <button class="search-btn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <div class="header-right">
                    <nav class="header-nav">
                        <a href="properties.html" class="nav-link">
                            <i class="fas fa-building"></i>
                            العقارات
                        </a>
                        <a href="favorites.html" class="nav-link">
                            <i class="fas fa-heart"></i>
                            المفضلة
                        </a>
                        <div class="user-menu">
                            <button class="user-menu-btn">
                                <i class="fas fa-bars"></i>
                                <i class="fas fa-user-circle"></i>
                            </button>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="property-details-container">
                <!-- Back Button -->
                <div class="mb-20">
                    <button class="btn-secondary" onclick="goBack()">← العودة</button>
                </div>

                <!-- Property Title -->
                <h1 id="property-title" class="page-title">تفاصيل العقار</h1>

                <!-- Property Images -->
                <div class="property-images">
                    <div class="image-gallery">
                        <div class="main-image-container">
                            <img id="main-image" src="" alt="" class="main-image">
                            <div class="image-overlay">
                                <button class="image-nav-btn prev-image" onclick="previousImage()">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="image-nav-btn next-image" onclick="nextImage()">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                                <div class="image-counter">
                                    <span id="current-image-index">1</span> / <span id="total-images">1</span>
                                </div>
                            </div>
                        </div>
                        <div id="thumbnail-images" class="thumbnail-images">
                            <!-- Thumbnail images will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Property Information -->
                <div class="property-info">
                    <div class="flex justify-between align-center mb-20">
                        <div id="property-price" class="property-price"></div>
                        <button id="favorite-btn" class="btn-favorite" onclick="togglePropertyFavorite()">
                            <i class="far fa-heart"></i>
                        </button>
                    </div>

                    <!-- Property Specifications -->
                    <div id="property-specs" class="property-specs">
                        <!-- Specs will be loaded here -->
                    </div>

                    <!-- Property Location -->
                    <div class="mb-20">
                        <h3 class="text-gold mb-20">
                            <i class="fas fa-map-marker-alt"></i>
                            الموقع
                        </h3>
                        <p id="property-location" class="text-white mb-15"></p>
                        
                        <!-- Map Section -->
                        

                    <!-- Property Description -->
                    <div class="mb-20">
                        <h3 class="text-gold mb-20">
                            <i class="fas fa-info-circle"></i>
                            الوصف
                        </h3>
                        <p id="property-description" class="text-white"></p>
                    </div>

                    <!-- Property Features -->
                    <div class="mb-20">
                        <h3 class="text-gold mb-20">
                            <i class="fas fa-check-circle"></i>
                            المميزات
                        </h3>
                        <div id="property-features" class="features-grid">
                            <!-- Features will be loaded here -->
                        </div>
                    </div>

                    <!-- Contact Section -->
                    <div class="contact-section">
                        <h3 class="text-gold mb-20">
                            <i class="fas fa-phone"></i>
                            تواصل معنا
                        </h3>
                        <div class="contact-buttons">
                            <a id="call-owner-btn" href="#" class="btn">
                                <i class="fas fa-phone"></i>
                                اتصل الآن
                            </a>
                            <button class="btn btn-secondary" onclick="sendWhatsApp()">
                                <i class="fab fa-whatsapp"></i>
                                واتساب
                            </button>
                            <button class="btn btn-secondary" onclick="sendEmail()">
                                <i class="fas fa-envelope"></i>
                                إرسال إيميل
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Similar Properties -->
                <section class="similar-properties mt-20">
                    <h2 class="text-gold mb-20">عقارات مشابهة</h2>
                    <div id="similar-properties" class="properties-grid">
                        <!-- Similar properties will be loaded here -->
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-item">
                <div class="nav-icon"><i class="fas fa-home"></i></div>
                <div class="nav-text">الرئيسية</div>
            </a>
            <a href="properties.html" class="nav-item">
                <div class="nav-icon"><i class="fas fa-building"></i></div>
                <div class="nav-text">العقارات</div>
            </a>
            <a href="categories.html" class="nav-item">
                <div class="nav-icon"><i class="fas fa-th-large"></i></div>
                <div class="nav-text">الفئات</div>
            </a>
            <a href="favorites.html" class="nav-item">
                <div class="nav-icon"><i class="fas fa-heart"></i></div>
                <div class="nav-text">المفضلة</div>
            </a>
            <a href="settings.html" class="nav-item">
                <div class="nav-icon"><i class="fas fa-cog"></i></div>
                <div class="nav-text">الإعدادات</div>
            </a>
        </div>
    </nav>

    <!-- Scripts -->
    <script src="data.js"></script>
    <script src="script.js"></script>
    <script>
        let currentProperty = null;
        let currentImageIndex = 0;
        let propertyImages = [];

        // Property details page specific functions
        function loadPropertyDetailsPage() {
            const propertyId = localStorage.getItem('bmd_current_property');
            if (!propertyId) {
                // Redirect to properties page if no property selected
                navigateTo('properties.html');
                return;
            }

            currentProperty = getPropertyById(propertyId);
            if (!currentProperty) {
                // Redirect to properties page if property not found
                navigateTo('properties.html');
                return;
            }

            displayPropertyDetails(currentProperty);
            loadSimilarProperties(currentProperty);
        }

        function displayPropertyDetails(property) {
            // Set page title
            document.title = `Bmd Immobilier - ${property.name}`;
            document.getElementById('property-title').textContent = property.name;

            // Set up images
            propertyImages = property.images || [];
            currentImageIndex = 0;
            
            if (propertyImages.length > 0) {
                // Set main image
                const mainImage = document.getElementById('main-image');
                mainImage.src = propertyImages[0];
                mainImage.alt = property.name;

                // Update image counter
                document.getElementById('current-image-index').textContent = '1';
                document.getElementById('total-images').textContent = propertyImages.length;

                // Set thumbnail images
                const thumbnailContainer = document.getElementById('thumbnail-images');
                thumbnailContainer.innerHTML = '';
                propertyImages.forEach((image, index) => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = image;
                    thumbnail.alt = `${property.name} - صورة ${index + 1}`;
                    thumbnail.className = `thumbnail ${index === 0 ? 'active' : ''}`;
                    thumbnail.onclick = () => changeMainImage(index);
                    thumbnailContainer.appendChild(thumbnail);
                });
            }

            // Set price
            document.getElementById('property-price').textContent = property.price;

            // Set specifications
            const specsContainer = document.getElementById('property-specs');
            specsContainer.innerHTML = '';

            const specs = [
                { label: 'المساحة', value: property.area, icon: 'fas fa-ruler-combined' },
                { label: 'النوع', value: property.type, icon: 'fas fa-home' },
                { label: 'المدينة', value: property.city, icon: 'fas fa-city' }
            ];

            if (property.bedrooms > 0) {
                specs.push({ label: 'غرف النوم', value: property.bedrooms, icon: 'fas fa-bed' });
            }

            if (property.bathrooms > 0) {
                specs.push({ label: 'الحمامات', value: property.bathrooms, icon: 'fas fa-bath' });
            }

            specs.forEach(spec => {
                const specItem = document.createElement('div');
                specItem.className = 'spec-item';
                specItem.innerHTML = `
                    <i class="${spec.icon}"></i>
                    <div>
                        <div class="spec-value">${spec.value}</div>
                        <div class="spec-label">${spec.label}</div>
                    </div>
                `;
                specsContainer.appendChild(specItem);
            });

            // Set location
            document.getElementById('property-location').textContent = property.location;

            // Set up map
            

            // Set description
            document.getElementById('property-description').textContent = property.description || 'لا يوجد وصف متاح';

            // Set features
            setupPropertyFeatures(property);

            // Set up contact information
            setupContactInfo(property);

            // Update favorite button
            updatePropertyFavoriteButton();
        }

        function setupPropertyMap(property) {
            const mapIframe = document.getElementById('property-map-iframe');
            // Use a generic location for demo - in real app, use property coordinates
            const location = encodeURIComponent(property.location + ', ' + property.city);
            const mapSrc = `https://www.google.com/maps/embed/v1/place?key=YOUR_API_KEY&q=${location}`;
            
            // For demo purposes, use a generic embed
            mapIframe.src = ``;
        }

        function setupPropertyFeatures(property) {
            const featuresContainer = document.getElementById('property-features');
            featuresContainer.innerHTML = '';

            // Default features - in real app, get from property data
            const features = [
                { name: 'مكيف', icon: 'fas fa-snowflake' },
                { name: 'حديقة', icon: 'fas fa-tree' },
                { name: 'أمن 24/7', icon: 'fas fa-shield-alt' },
                { name: 'إنترنت', icon: 'fas fa-wifi' }
            ];

            features.forEach(feature => {
                const featureItem = document.createElement('div');
                featureItem.className = 'feature-item';
                featureItem.innerHTML = `
                    <i class="${feature.icon}"></i>
                    <span>${feature.name}</span>
                `;
                featuresContainer.appendChild(featureItem);
            });
        }

        function setupContactInfo(property) {
            const callBtn = document.getElementById('call-owner-btn');
            if (property.ownerPhone) {
                callBtn.href = `tel:${property.ownerPhone}`;
            } else {
                callBtn.href = 'tel:+1234567890'; // Default number for demo
            }
        }

        function changeMainImage(index) {
            if (index >= 0 && index < propertyImages.length) {
                currentImageIndex = index;
                document.getElementById('main-image').src = propertyImages[index];
                
                // Update image counter
                document.getElementById('current-image-index').textContent = index + 1;
                
                // Update active thumbnail
                document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                    thumb.classList.toggle('active', i === index);
                });
            }
        }

        function previousImage() {
            const newIndex = currentImageIndex > 0 ? currentImageIndex - 1 : propertyImages.length - 1;
            changeMainImage(newIndex);
        }

        function nextImage() {
            const newIndex = currentImageIndex < propertyImages.length - 1 ? currentImageIndex + 1 : 0;
            changeMainImage(newIndex);
        }

        function togglePropertyFavorite() {
            if (currentProperty) {
                toggleFavorite(currentProperty.id);
                updatePropertyFavoriteButton();
            }
        }

        function updatePropertyFavoriteButton() {
            const favoriteBtn = document.getElementById('favorite-btn');
            if (currentProperty && favorites.includes(currentProperty.id)) {
                favoriteBtn.classList.add('active');
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
            } else {
                favoriteBtn.classList.remove('active');
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
            }
        }

        function loadSimilarProperties(property) {
            const container = document.getElementById('similar-properties');
            if (!container) return;

            // Find similar properties based on type and city
            let similarProperties = properties.filter(p => 
                p.id !== property.id && 
                (p.type === property.type || p.city === property.city)
            );

            // If not enough similar properties, add random ones
            if (similarProperties.length < 3) {
                const additionalProperties = properties.filter(p => 
                    p.id !== property.id && 
                    !similarProperties.some(sp => sp.id === p.id)
                );
                similarProperties = [...similarProperties, ...additionalProperties];
            }

            // Limit to 3 properties
            similarProperties = similarProperties.slice(0, 3);

            container.innerHTML = '';
            similarProperties.forEach(prop => {
                const propertyCard = createPropertyCard(prop);
                container.appendChild(propertyCard);
            });
        }

        function openInGoogleMaps() {
            if (currentProperty) {
                const location = encodeURIComponent(currentProperty.location + ', ' + currentProperty.city);
                window.open(`https://www.google.com/maps/search/${location}`, '_blank');
            }
        }

        function getDirections() {
            if (currentProperty) {
                const location = encodeURIComponent(currentProperty.location + ', ' + currentProperty.city);
                window.open(`https://www.google.com/maps/dir//${location}`, '_blank');
            }
        }

        function sendWhatsApp() {
            if (currentProperty) {
                const message = encodeURIComponent(`مرحباً، أنا مهتم بالعقار: ${currentProperty.name}`);
                const phone = currentProperty.ownerPhone || '+1234567890';
                window.open(`https://wa.me/${phone}?text=${message}`, '_blank');
            }
        }

        function sendEmail() {
            if (currentProperty) {
                const subject = encodeURIComponent(`استفسار عن العقار: ${currentProperty.name}`);
                const body = encodeURIComponent(`مرحباً،\n\nأنا مهتم بالعقار التالي:\n${currentProperty.name}\nالموقع: ${currentProperty.location}\nالسعر: ${currentProperty.price}\n\nأرجو التواصل معي للمزيد من التفاصيل.\n\nشكراً`);
                window.open(`mailto:info@bmdimmobilier.com?subject=${subject}&body=${body}`);
            }
        }

        function goBack() {
            window.history.back();
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Update favorites from localStorage
            favorites = JSON.parse(localStorage.getItem('bmd_favorites')) || [];
        });
    </script>
</body>
</html>

